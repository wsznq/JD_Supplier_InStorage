webpackJsonp([23],{pbRf:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("Xxa5"),s=n.n(i),r=n("mvHQ"),o=n.n(r),a=n("woOf"),l=n.n(a),u=n("exGp"),f=n.n(u),c=n("Dd8w"),d=n.n(c),_=n("7t+N"),h=n.n(_),E=n("NYxO"),v=n("1h8J"),m=n("ignk"),p=n("UNGY"),g=n("rHil"),M=n("2sLL"),N=n("wpcj"),Z=(m.a,p.a,g.a,M.a,N.a,d()({},Object(E.b)({userInfo:function(t){return t.user.userInfo},user:function(t){return t.mutaions.suplierinfo}})),{data:function(){return{bilno:this.$route.query.DeliNo,value:'{"BarCodeType":"Deli","BillNO":"310000000016"} ',isAll:!1,startDate:"",endDate:"",visibility:!1,visibility2:!1,widths:60,widths2:60,ZNUMPAGE:"",ZREMARK:"",tableHead:["物料编号","物料名称","尺码","数量","已送货数量","欠数","本次送货数量","指令","型体","通知单号"],tableHead2:["尺码","数量","已送货数量","欠数","本次送货数量","分配型体","库位"],info:[],form:{MES_HeadsString:[{BUKRS:"1000",ZDELINO:"",LIFNR:"",ZAUDITOE:"",ZMODIFIER:"",ZMODIFYOPENID:"",ZREMARK:"",ZNUMPAGE:""}],MES_ItemsString:[]}}},components:{XTable:m.a,Datetime:p.a,Group:g.a,XButton:M.a,Qrcode:N.a},computed:d()({},Object(E.b)({userInfo:function(t){return t.user.userInfo},user:function(t){return t.mutaions.suplierinfo}})),mounted:function(){this.getWXShow(),this.widths=h()(window).width()/5,this.widths2=h()(window).width()},methods:{getWXShow:function(){var t=this;try{Object(v.b)({DeliNO:this.$route.query.DeliNo,I_ZCALLER:"OUT"}).then(function(e){e.forEach(function(e,n){t.info.push(e),t.ZREMARK=e.ZREMARK,t.ZNUMPAGE=e.ZNUMPAGE}),t.total(),t.$nextTick(function(){t.init()})})}catch(t){this.$store.commit("updateLoadingStatus",{isLoading:!1})}finally{this.$emit("close"),this.$store.commit("updateLoadingStatus",{isLoading:!1})}console.log(this.info)},watchValue:function(t){var e=this,n=parseFloat(this.info[t].ZDELIQTY),i=parseFloat(this.info[t].WK_NUM);n<0?this.info[t].ZDELIQTY=0:n>i&&(this.$vux.toast.text("送货数量超出"),this.info[t].ZDELIQTY=i,this.$set(this.info[t],"status",!1));var s=0;this.info.forEach(function(t,n){n!==e.info.length-1&&(s+=parseFloat(t.ZDELIQTY))}),this.info[this.info.length-1].ZDELIQTY=s},total:function(){var t=0,e=0,n=0,i=0;this.info.forEach(function(s){t+=parseFloat(s.MENGE),e+=parseFloat(s.YK_NUM),n+=parseFloat(s.WK_NUM),i+=parseFloat(s.ZDELIQTY)}),1===this.info.length?this.info.push({SIZE1:"合计",MENGE:t,YK_NUM:e,WK_NUM:n,ZDELIQTY:i}):this.info.push({MATNR:"合计",MENGE:t,YK_NUM:e,WK_NUM:n,ZDELIQTY:i})},confirm:function(){var t=this;return f()(s.a.mark(function e(){var n,i;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("------11111"),console.log(t.ZNUMPAGE),console.log("------222222"),!(t.info.length<=0)){e.next=6;break}return t.$vux.toast.text("无数据"),e.abrupt("return");case 6:if(""!==t.ZNUMPAGE){e.next=9;break}return t.$vux.toast.text("必须输入件数"),e.abrupt("return");case 9:if(!(parseInt(t.ZNUMPAGE)<0)){e.next=12;break}return t.$vux.toast.text("输入件数不能小于0"),e.abrupt("return");case 12:return t.form.MES_ItemsString=[],t.form.MES_HeadsString[0].ZDELINO=t.$route.query.DeliNo,t.form.MES_HeadsString[0].ZMODIFIER=t.user.supplierInfo.FContact,t.form.MES_HeadsString[0].ZMODIFYOPENID=t.userInfo,t.form.MES_HeadsString[0].BUKRS="1000",t.form.MES_HeadsString[0].LIFNR=t.user.supplierInfo.FNumber,t.form.MES_HeadsString[0].ZREMARK=t.ZREMARK,t.form.MES_HeadsString[0].ZNUMPAGE=t.ZNUMPAGE,n={EBELN:"",EBELP:"",ETENR:"",MATNR:"",VBELN:"",ZDELIQTY:"",ZZGCXT:"",ZREMARK:""},t.info.forEach(function(e,i){if(i!==t.info.length-1){for(var s in e)"ZZXTNO"===s?n.ZZGCXT=e[s]:n[s]=e[s];t.form.MES_ItemsString.push(n),n=l()({},{EBELN:"",EBELP:"",ETENR:"",MATNR:"",VBELN:"",ZDELIQTY:"",ZZGCXT:"",ZREMARK:""})}}),t.form.MES_HeadsString=o()(t.form.MES_HeadsString),t.form.MES_ItemsString=o()(t.form.MES_ItemsString),console.log(t.form),e.prev=25,e.next=28,Object(v.u)(t.form);case 28:i=e.sent,console.log(i),t.form.MES_HeadsString=JSON.parse(t.form.MES_HeadsString),t.form.MES_ItemsString=JSON.parse(t.form.MES_ItemsString),t.$vux.toast.text(i),t.$router.push({path:"/result",query:{No:i.replace(/[^0-9]/gi,"")}}),e.next=41;break;case 36:e.prev=36,e.t0=e.catch(25),console.log(e.t0),t.form.MES_HeadsString=JSON.parse(t.form.MES_HeadsString),t.form.MES_ItemsString=JSON.parse(t.form.MES_ItemsString);case 41:case"end":return e.stop()}},e,t,[[25,36]])}))()},vueTouch:function(t){"INPUT"!==t.target.tagName&&console.log(t)},toInfo:function(t){console.log(t)},change:function(){},init:function(){var t=h()(window),e=h()(".t_r_content"),n=h()(".t_l_freeze"),i=n.find("table"),s=h()(".t_r_t table"),r=this,o=void 0;function a(){t.height();o=1===r.info.length?40:40*(r.info.length<10?r.info.length:10),console.log(o),n.height(o),e.height(o)}a(),t.on("resize",a);var l=new IScroll(".t_r_content",{scrollX:!0,scrollY:!0,probeType:3});function u(){var t=this.y,e=this.x;i.css("transform","translate(0px, "+t+"px) translateZ(0px)"),s.css("transform","translate("+e+"px, 0px) translateZ(0px)")}e.on("touchmove mousewheel",function(t){t.preventDefault()}),l.on("scroll",u),l.on("scrollEnd",u)}}}),S={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wrap",attrs:{id:"wrap"}},[2===t.info.length?n("div",{staticClass:"item-top"},[n("div",{staticClass:"item"},[t.info[0].VBELN?n("div",{staticClass:"item-left"},[t._v("指令： "+t._s(t.info[0].VBELN))]):t._e(),t._v(" "),t.info[0].ZZXTNO?n("div",{staticClass:"item-right"},[t._v("型体："+t._s(t.info[0].ZZXTNO))]):t._e()]),t._v(" "),n("div",{staticClass:"item mt20"},[n("div",{staticClass:"item-left"},[t._v("收料通知单号："+t._s(t.info[0].EBELN))]),t._v(" "),n("div",{staticClass:"item-right"},[t._v("物料名称："+t._s(t.info[0].MAKTX_YB))])])]):t._e(),t._v(" "),n("div",{staticClass:"data-table"},[n("div",{staticClass:"t_r"},[n("div",{staticClass:"t_r_t"},[n("table",{style:2===t.info.length?"width: "+(t.widths2+80)+"px":"width: 1070px"},[n("tbody",[2!==t.info.length?n("tr",t._l(t.tableHead,function(e,i){return n("th",{key:i,attrs:{width:"110"}},[t._v(t._s(e))])}),0):n("tr",t._l(t.tableHead2,function(e,i){return n("th",{key:i,attrs:{width:"80"}},[t._v(t._s(e))])}),0)])])]),t._v(" "),n("div",{staticClass:"t_r_content"},[n("table",{style:2===t.info.length?"width: "+(t.widths2+80)+"px ":"width: 1070px"},[n("tbody",{directives:[{name:"tap",rawName:"v-tap",value:function(e){return t.vueTouch(e)},expression:"(e)=>vueTouch(e)"}]},t._l(t.info,function(e,i){return n("tr",{key:i,staticClass:"to",attrs:{id:i}},[2!==t.info.length?n("td",{attrs:{width:"110"}},[t._v(t._s(e.MATNR))]):t._e(),t._v(" "),2!==t.info.length?n("td",{attrs:{width:"110"}},[t._v(t._s(e.MAKTX_YB))]):t._e(),t._v(" "),n("td",{attrs:{width:"110"}},[t._v(t._s(e.SIZE1))]),t._v(" "),n("td",{attrs:{width:"110"}},[t._v(t._s(e.MENGE))]),t._v(" "),n("td",{attrs:{width:"110"}},[t._v(t._s(e.YK_NUM))]),t._v(" "),n("td",{attrs:{width:"110"}},[t._v(t._s(e.WK_NUM))]),t._v(" "),i!==t.info.length-1?n("td",{attrs:{width:"110"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.ZDELIQTY,expression:"item.ZDELIQTY"}],staticClass:"tr-input",staticStyle:{width:"80px",background:"white"},attrs:{type:"number",id:"blurInput",disabled:i===t.info.length-1},domProps:{value:e.ZDELIQTY},on:{change:function(e){return t.watchValue(i)},input:function(n){n.target.composing||t.$set(e,"ZDELIQTY",n.target.value)}}})]):n("td",[t._v("\n                  "+t._s(e.ZDELIQTY)+"\n              ")]),t._v(" "),n("td",{attrs:{width:"110"}},[t._v(t._s(e.ZXT))]),t._v(" "),n("td",{attrs:{width:"110"}},[t._v(t._s(e.ZLGORT)+t._s(e.LGOBE))]),t._v(" "),2!==t.info.length?n("td",{attrs:{width:"110"}},[t._v(t._s(e.VBELN))]):t._e(),t._v(" "),2!==t.info.length?n("td",{attrs:{width:"110"}},[t._v(t._s(e.ZZXTNO))]):t._e(),t._v(" "),2!==t.info.length?n("td",{attrs:{width:"110"}},[t._v(t._s(e.EBELN))]):t._e()])}),0)])]),t._v(" "),n("div",{staticClass:"t_r Remarks"},[n("table",[n("tr",[n("td",{attrs:{width:"80"}},[t._v("总件数")]),t._v(" "),n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.ZNUMPAGE,expression:"ZNUMPAGE"}],attrs:{type:"number",placeholder:"件数必须输入",disabled:"disabled"},domProps:{value:t.ZNUMPAGE},on:{input:function(e){e.target.composing||(t.ZNUMPAGE=e.target.value)}}})]),t._v(" "),n("td",{attrs:{width:"80"}},[t._v("备 注")]),t._v(" "),n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.ZREMARK,expression:"ZREMARK"}],attrs:{type:"text",placeholder:"备注输入"},domProps:{value:t.ZREMARK},on:{input:function(e){e.target.composing||(t.ZREMARK=e.target.value)}}})])])])])])]),t._v(" "),n("x-button",{staticClass:"comfirm",attrs:{gradients:["#d93309","#aa0000"]},nativeOn:{click:function(e){return t.confirm(e)}}},[t._v("提交")])],1)},staticRenderFns:[]};var w=n("VU/8")(Z,S,!1,function(t){n("zxV8")},"data-v-524a898a",null);e.default=w.exports},zxV8:function(t,e){}});
//# sourceMappingURL=23.dd5379d1a5cea3a209d2.js.map